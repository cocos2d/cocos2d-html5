/**
 * Created by Huabin LING on 1/2/14.
 */

var ButtonStyling = GuiTest.extend({

    ctor:function () {
        this._super();
        
        var winSize = cc.Director.getInstance().getWinSize();

        var layer = cc.Node.create();
        this.addChild(layer, 1);

        var space = 10; // px
        var max_w = 0, max_h = 0;
        // Create buttons in 3 * 3 grid layout
        for (var i = 0; i < 3; i++) {
            for (var j = 0; j < 3; j++) {
                // Create and add the button
                var button = this.standardButtonWithTitle((0 | (Math.random() * 30)) + "");
                button.setAdjustBackgroundImage(false);  // Tells the button that the background image must not be adjust
                // It'll use the prefered size of the background image
                button.setPosition(button.getContentSize().width / 2 + (button.getContentSize().width + space) * i,
                    button.getContentSize().height / 2 + (button.getContentSize().height + space) * j);
                layer.addChild(button);

                max_w = Math.max(button.getContentSize().width * (i + 1) + space * i, max_w);
                max_h = Math.max(button.getContentSize().height * (j + 1) + space * j, max_h);
            }
        }

        layer.setAnchorPoint(0.5, 0.5);
        layer.setContentSize(max_w, max_h);
        layer.setPosition(winSize.width / 2.0, winSize.height / 2.0);

        // Add the black background
        var backgroundButton = cc.Scale9Sprite.create(res.buttonBackground_png);
        backgroundButton.setContentSize(max_w + 14, max_h + 14);
        backgroundButton.setPosition(winSize.width / 2.0, winSize.height / 2.0);
        this.addChild(backgroundButton);
    },

    // Helper function to create the button with a title
    standardButtonWithTitle:function (title) {
        /** Creates and return a button with a default background and title color. */
        var backgroundButton = cc.Scale9Sprite.create(res.button_png);
        backgroundButton.setPreferredSize(cc.size(45, 45));  // Set the prefered size
        var backgroundHighlightedButton = cc.Scale9Sprite.create(res.buttonHighlighted_png);
        backgroundHighlightedButton.setPreferredSize(cc.size(45, 45));  // Set the prefered size

        var titleButton = cc.LabelTTF.create(title, "Marker Felt", 30);
        titleButton.setColor(cc.c3b(159, 168, 176));

        var button = cc.ControlButton.create(titleButton, backgroundButton);
        button.setBackgroundSpriteForState(backgroundHighlightedButton, cc.CONTROL_STATE_HIGHLIGHTED);
        button.setTitleColorForState(cc.WHITE, cc.CONTROL_STATE_HIGHLIGHTED);

        return button;
    }
});

ButtonStyling.create = function () {
    return new ButtonStyling();
};