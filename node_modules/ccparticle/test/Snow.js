/**
 * Created by Huabin LING on 12/31/13.
 */

var Snow = ParticleTest.extend({
    onEnter:function () {
        this._super();

        // Create particle emitter
        this._emitter = cc.ParticleSnow.create();
        this._background.addChild(this._emitter, 10);

        this._emitter.setLife(3);
        this._emitter.setLifeVar(1);

        // gravity
        this._emitter.setGravity(cc.p(0, -10));

        // speed of particles
        this._emitter.setSpeed(130);
        this._emitter.setSpeedVar(30);

        var startColor = this._emitter.getStartColor();
        startColor.r = 0.9;
        startColor.g = 0.9;
        startColor.b = 0.9;
        this._emitter.setStartColor(startColor);

        var startColorVar = this._emitter.getStartColorVar();
        startColorVar.b = 0.1;
        this._emitter.setStartColorVar(startColorVar);

        this._emitter.setEmissionRate(this._emitter.getTotalParticles() / this._emitter.getLife());

        // Set particle texture
        this._emitter.setTexture(cc.TextureCache.getInstance().addImage(res.snow_png));
        // Set particle shapeType (only on canvas render mode)
        if (this._emitter.setShapeType)
            this._emitter.setShapeType(cc.PARTICLE_STAR_SHAPE);

        this._emitter.setPosition(200, cc.Director.getInstance().getWinSize().height - 80);
        this.scheduleUpdate();
    }
});

Snow.create = function() {
    var layer = new Snow();
    return layer;
}